# DocLens: поиск денежных обязательств в текстах договоров

Работу выполнил: **Евстафьев Ярослав Михайлович**

### Задача

В данном проекте решается задача **бинарной классификации текста**.
Модель должна определить, относится ли конкретный пункт договора к финансовым условиям (`is_money = 1`) или нет (
`is_money = 0`).

### Данные

Используется датасет **LEDGAR** (подмножество бенчмарка `lex_glue`).
В качестве целевого класса ("Деньги") рассматриваются параграфы со следующими метками:

* *Base Salary, Benefits, Costs, Expenses, Fees, Indemnifications, Indemnity, Insurances, Payments, Tax Withholdings,
  Taxes, Use Of Proceeds, Withholdings.*

### Модель и метрики

* **Базовая модель:** `microsoft/deberta-v3-base`.
* **Метрики:** F1 (основная), Precision, Recall.

---

## Настройка и запуск

Проект использует менеджер пакетов **uv**

### 1. Установка зависимостей

```bash
uv sync
```

### 2. Настройка pre-commit

```bash
pre-commit install
pre-commit run -a
```

### 3. Скачивание данных

Данные и модели версионируются с помощью DVC. Удаленное хранилище настроено на S3 в Yandex Cloud

```bash
dvc pull
```

`dvc` скачает обработанные данные в директорию `data/ledgar/processed`

### 4. Train

Запуск обучения

```bash
doclens-train
```

*Конфиг: `config/train.yaml`*

**Управление гиперпараметрами**

Вы можете переопределять параметры прямо из командной строки. Например, чтобы изменить **learning rate** и **количество
эпох**:

```bash
doclens-train model.lr=1e-4 model.epochs=5
```

---

## Доп. информация

Поскольку в инструкции выше использовался `dvc`, мы сразу получаем обработанные данные, но в проекте также есть
возможность получить данные из исходников

### 1. Загрузка данных

Скачивает сырой датасет LEDGAR и сохраняет его в parquet-файлы

```bash
doclens-download
```

*Конфиг: `config/download.yaml`*

### 2. Обработка данных

Формирует целевую переменную `is_money` на основе списка меток

```bash
doclens-process
```

*Конфиг: `config/process.yaml`*

## Структура проекта

```text
.dvc/                   # Настройки DVC
config/                 # Конфигурации Hydra
data/                   # Данные (управляются DVC)
doclens/                # Исходный код пакета
    cmd.py              # Точки входа cli
    data/               # Логика работы с данными
    train/              # Логика обучения
pyproject.toml          # Описание проекта, зависимостей и сборки
README.md
```
